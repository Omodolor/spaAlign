<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>spaAlign • spaAlign</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="spaAlign">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">spaAlign</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/getting-started.html">spaAlign</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Omodolor/spaAlign"><span class="fa fab fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>spaAlign</h1>
                        <h4 data-toc-skip class="author"></h4>
            
            <h4 data-toc-skip class="date">26 January, 2026</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/Omodolor/spaAlign/blob/HEAD/vignettes/getting-started.Rmd" class="external-link"><code>vignettes/getting-started.Rmd</code></a></small>
      <div class="d-none name"><code>getting-started.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a>
</h2>
<p>High‐resolution HHXRF measurements provide a dense, quasi‐continuous
elemental profile downcore and therefore were used as the vertical
reference grid for multivariate analysis and chemofacies definition.
Sparse plug‐based measurements (e.g., TOC and total porosity) and
XRD‐derived mineralogy/indices (e.g., total clay and MBI) were
depth-aligned to the HHXRF grid by interpolating each variable to the
nearest HHXRF depth increments using a one-dimensional linear
interpolation routine (spaAlign; spa_align). All input datasets were
first standardized to a common depth column name (“Depth”), sorted by
depth, and screened for non-data columns (e.g., Formation). For each
property dataset, values were interpolated to the HHXRF depths using
rule-based behavior that restricts interpolation to the supported depth
interval (no extrapolation beyond the available plug/XRD depth range
under rule = 1). The resulting aligned dataset preserves the
stratigraphic order of observations and enables direct, depth-consistent
comparison of elemental geochemistry, chemofacies assignments, and
reservoir-quality properties along the core.</p>
</div>
<div class="section level2">
<h2 id="justification">Justification<a class="anchor" aria-label="anchor" href="#justification"></a>
</h2>
<p>This approach is geologically appropriate because stratigraphic
interpretation and reservoir-quality characterization require that all
measurements be referenced to a consistent vertical framework. HHXRF
data are collected at much higher sampling density than plug
measurements and capture fine-scale centimeter- to decimeter-scale
variability, making them the most suitable dataset to define continuous
downcore boundaries and chemofacies. In contrast, plug-based TOC,
porosity, and XRD measurements are sparse and discontinuous; comparing
them directly to HHXRF-derived chemofacies without alignment would
introduce artificial offsets and could misassign properties to the wrong
stratigraphic interval. By interpolating sparse properties onto the
HHXRF depth grid, each property value is evaluated within the same
stratigraphic ordering used to define chemofacies, improving internal
consistency and interpretability. Importantly, values that occur outside
the HHXRF depth coverage (or outside the supported range of the plug/XRD
data when extrapolation is disabled) cannot be assigned to a chemofacies
without introducing unsupported assumptions; therefore, such points are
treated separately and excluded from chemofacies-based statistics.
Overall, aligning all properties to a common HHXRF depth framework
minimizes depth mismatch, preserves geological ordering, and provides
the most defensible basis for describing chemofacies in terms of
reservoir-quality attributes.</p>
</div>
<div class="section level2">
<h2 id="short-how-it-was-done">Short “how it was done”<a class="anchor" aria-label="anchor" href="#short-how-it-was-done"></a>
</h2>
<ul>
<li><p>Standardized depth column name to Depth across XRF, TOC,
porosity, and XRD tables.</p></li>
<li><p>Sorted each dataset by depth and removed non-numeric/non-required
fields (e.g., Formation).</p></li>
<li><p>Used HHXRF depth vector as the target/ref grid.</p></li>
<li><p>Interpolated TOC, porosity, and XRD-derived variables to each
HHXRF depth using linear interpolation (spa_align).</p></li>
<li><p>Used rule = 1 to avoid extrapolating beyond available measured
intervals (prevents inventing values outside the data support).</p></li>
<li><p>Generated an aligned dataset where each HHXRF depth has
associated reservoir-quality variables when supported by the plug/XRD
depth coverage.</p></li>
</ul>
<p>Because chemofacies are defined only on the HHXRF reference depths,
plug measurements outside the HHXRF depth coverage cannot be assigned a
chemofacies label and are excluded from chemofacies-based summaries to
avoid unsupported stratigraphic extrapolation.</p>
</div>
<div class="section level2">
<h2 id="setup-load-packages-used-across-the-workflow">Setup: load packages used across the workflow<a class="anchor" aria-label="anchor" href="#setup-load-packages-used-across-the-workflow"></a>
</h2>
<p>Purpose: - read input datasets (XRF, XRD, TOC, Porosity) - compute
derived metrics (MBI) - align sparse plug data to continuous XRF depth
using spaAlign - generate multi-track depth plots + boxplots by
chemofacies</p>
</div>
<div class="section level2">
<h2 id="load-the-required-libraries">Load the required libraries<a class="anchor" aria-label="anchor" href="#load-the-required-libraries"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the required libraries</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://had.co.nz/plyr" class="external-link">plyr</a></span><span class="op">)</span>                         </span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://omodolor.github.io/spaAlign/" class="external-link">spaAlign</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hadley/reshape" class="external-link">reshape2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'dplyr'</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:plyr':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     arrange, count, desc, failwith, id, mutate, rename, summarise,</span></span>
<span><span class="co">##     summarize</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:stats':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     filter, lag</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:base':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     intersect, setdiff, setequal, union</span></span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org" class="external-link">readr</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="increase-printing-precision-useful-for-qc-on-depth-alignment">Increase printing precision (useful for QC on depth alignment<a class="anchor" aria-label="anchor" href="#increase-printing-precision-useful-for-qc-on-depth-alignment"></a>
</h2>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"digits"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 7</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>digits<span class="op">=</span><span class="fl">15</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="portage-here-we-are-using-the-tracker-core-portage-county-api-34133244490000-as-case-study">Portage ( here, we are using the Tracker core ,Portage County; API
34133244490000 as case study)<a class="anchor" aria-label="anchor" href="#portage-here-we-are-using-the-tracker-core-portage-county-api-34133244490000-as-case-study"></a>
</h2>
<p>Load + filter XRF, then split into Utica vs Point Pleasant</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">"/mnt/vstor/CSE_MSE_RXF131/staging/sdle/geospatial/core_xrf_xrd/XRF_two_core_in1/chaper_3/Potage3rd.csv"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## New names:</span></span>
<span><span class="co">## <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">690</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">48</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span> <span style="font-weight: bold;">Delimiter:</span> "," <span style="color: #BB0000;">chr</span></span></span>
<span><span class="co">## (2): Formation, Core <span style="color: #00BB00;">dbl</span> (46): Depth_ft...1, Al_wt%, Si_wt%, K_wt%, Ti_wt%,</span></span>
<span><span class="co">## Fe_wt%, S_wt%, Mg_wt%...</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Use `spec()` to retrieve the full column specification for this data. <span style="color: #00BBBB;">ℹ</span></span></span>
<span><span class="co">## Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> `Depth_ft` -&gt; `Depth_ft...1`</span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> `Depth_ft` -&gt; `Depth_ft...45`</span></span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Standardize depth column name for downstream consistency</span></span>
<span><span class="va">Data</span> <span class="op">&lt;-</span> <span class="va">Data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/plyr/man/rename.html" class="external-link">rename</a></span><span class="op">(</span>Depth <span class="op">=</span> <span class="va">`Depth_ft...1`</span><span class="op">)</span></span>
<span><span class="co"># Keep only columns required for plotting/alignment (remove precomputed ratios, identifiers, and any duplicated depth column)</span></span>
<span></span>
<span><span class="va">Data_filtered</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">Data</span>,</span>
<span>  <span class="op">-</span><span class="va">Chemofacies</span>,</span>
<span>  <span class="op">-</span><span class="va">`Depth_ft...45`</span>,</span>
<span>  <span class="op">-</span><span class="va">`K/Al`</span>,</span>
<span>  <span class="op">-</span><span class="va">`Zn/Al`</span>,</span>
<span>  <span class="op">-</span><span class="va">`Si/Ca`</span>,</span>
<span>  <span class="op">-</span><span class="va">SGR</span>,</span>
<span>  <span class="op">-</span><span class="va">`Sr/Ca`</span>,</span>
<span>  <span class="op">-</span><span class="va">`V/Al`</span>,</span>
<span>  <span class="op">-</span><span class="va">`Mg/Al`</span>,</span>
<span>  <span class="op">-</span><span class="va">`Rb/Al`</span>,</span>
<span>  <span class="op">-</span><span class="va">`Si/Al`</span>,</span>
<span>  <span class="op">-</span><span class="va">`Ti/Al`</span>,</span>
<span>  <span class="op">-</span><span class="va">`Zr/Al`</span>,</span>
<span>  <span class="op">-</span><span class="va">`Si/Ti`</span>,</span>
<span>  <span class="op">-</span><span class="va">`Cu/Al`</span>,</span>
<span>  <span class="op">-</span><span class="va">`Fe/Al`</span>,</span>
<span>  <span class="op">-</span><span class="va">`Ni/Al`</span>,</span>
<span>  <span class="op">-</span><span class="va">`Mo/Al`</span>,</span>
<span>  <span class="op">-</span><span class="va">`S/Al`</span>,</span>
<span>  <span class="op">-</span><span class="va">`U/Al`</span>,</span>
<span>  <span class="op">-</span><span class="va">`Al_ppm`</span>,</span>
<span>  <span class="op">-</span><span class="va">`Core`</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Keep only Utica (U...) and Point Pleasant (P...) intervals</span></span>
<span></span>
<span><span class="va">Data_filtered2</span> <span class="op">&lt;-</span> <span class="va">Data_filtered</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_starts.html" class="external-link">str_starts</a></span><span class="op">(</span><span class="va">Formation</span>, <span class="st">"U"</span><span class="op">)</span> <span class="op">|</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_starts.html" class="external-link">str_starts</a></span><span class="op">(</span><span class="va">Formation</span>, <span class="st">"P"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Data_filtered2</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 631 × 26</span></span></span>
<span><span class="co">##    Depth `Al_wt%` `Si_wt%` `K_wt%` `Ti_wt%` `Fe_wt%` `S_wt%` `Mg_wt%` `Ca_wt%`</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> <span style="text-decoration: underline;">6</span>141      4.9      16.7    2.22    0.001     4.97    1.78     0.3      1.99</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> <span style="text-decoration: underline;">6</span>142.     7.98     28.2    2.83    0.001     5.32    2.39     1.3      0.95</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> <span style="text-decoration: underline;">6</span>142      7.4      28.8    2.69    0.57      5.02    2.65     1.12     2.26</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> <span style="text-decoration: underline;">6</span>143.     8.3      29.3    2.7     0.57      5.58    3.03     1.72     1.29</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> <span style="text-decoration: underline;">6</span>143      5.15     26.2    1.7     0.001     4.71    1.89     0.9      2.31</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> <span style="text-decoration: underline;">6</span>144.     7.49     28.6    2.69    0.001     5.08    2.21     1.38     1.31</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> <span style="text-decoration: underline;">6</span>144      7.02     24.3    2.39    0.49      4.17    1.82     1.2      8.4 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> <span style="text-decoration: underline;">6</span>145.     7.53     27.3    2.68    0.001     4.87    2.46     1.24     1.16</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> <span style="text-decoration: underline;">6</span>145      5.28     18.1    2.3     0.001     4.66    1.97     0.3      2.16</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> <span style="text-decoration: underline;">6</span>146.     8.24     28.2    2.99    0.64      5.05    2.29     1.19     1.74</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 621 more rows</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 17 more variables: `Sr_wt%` &lt;dbl&gt;, `P_wt%` &lt;dbl&gt;, Mo_ppm &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   V_ppm &lt;dbl&gt;, U_ppm &lt;dbl&gt;, Ni_ppm &lt;dbl&gt;, Cu_ppm &lt;dbl&gt;, Zn_ppm &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   Th_ppm &lt;dbl&gt;, Rb_ppm &lt;dbl&gt;, Zr_ppm &lt;dbl&gt;, Pb_ppm &lt;dbl&gt;, Formation &lt;chr&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   chemofacies &lt;dbl&gt;, Factor1 &lt;dbl&gt;, Factor2 &lt;dbl&gt;, Factor3 &lt;dbl&gt;</span></span></span></code></pre>
</div>
<div class="section level2">
<h2 id="split-xrf-into-two-interval-specific-datasets-and-write-to-csv">Split XRF into two interval-specific datasets and write to CSV<a class="anchor" aria-label="anchor" href="#split-xrf-into-two-interval-specific-datasets-and-write-to-csv"></a>
</h2>
<p>These are used as inputs to spa_align()</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Rows where Formation starts with "U" Utica</span></span>
<span><span class="va">Data_U</span> <span class="op">&lt;-</span> <span class="va">Data_filtered2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_starts.html" class="external-link">str_starts</a></span><span class="op">(</span><span class="va">Formation</span>, <span class="st">"U"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">Data_U</span>, <span class="st">"Potage_xrf_Utica.csv"</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Rows where Formation starts with "P" Point Pleasant</span></span>
<span><span class="va">Data_P</span> <span class="op">&lt;-</span> <span class="va">Data_filtered2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_starts.html" class="external-link">str_starts</a></span><span class="op">(</span><span class="va">Formation</span>, <span class="st">"P"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">Data_P</span>, <span class="st">"Potage_xrf_PP.csv"</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="read-xrd-file-and-calculate-mbi-from-xrd">Read xrd file and calculate MBI from xrd<a class="anchor" aria-label="anchor" href="#read-xrd-file-and-calculate-mbi-from-xrd"></a>
</h2>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">XRD_Portage</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">"/mnt/vstor/CSE_MSE_RXF131/staging/sdle/geospatial/core_xrf_xrd/XRF_two_core_in1/chaper_3/XRD_Portage.csv"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">32</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">13</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">## <span style="font-weight: bold;">Delimiter:</span> ","</span></span>
<span><span class="co">## <span style="color: #BB0000;">chr</span>  (1): Formation</span></span>
<span><span class="co">## <span style="color: #00BB00;">dbl</span> (12): Depth_ft, Quartz, Plagioclase, K-Feldspar, Calcite, Siderite, Anke...</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span></code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#View(XRD_Portage)</span></span>
<span></span>
<span><span class="va">XRD_Portage</span> <span class="op">&lt;-</span> <span class="va">XRD_Portage</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    MBI <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="op">(</span><span class="va">Quartz</span> <span class="op">+</span> <span class="va">`K-Feldspar`</span> <span class="op">+</span> <span class="va">Calcite</span> <span class="op">+</span> <span class="va">Dolomite</span><span class="op">)</span> <span class="op">/</span></span>
<span>                <span class="op">(</span><span class="va">Quartz</span> <span class="op">+</span> <span class="va">Plagioclase</span> <span class="op">+</span> <span class="va">`K-Feldspar`</span> <span class="op">+</span> <span class="va">Calcite</span> <span class="op">+</span> <span class="va">Siderite</span> <span class="op">+</span> <span class="va">Ankerite</span> <span class="op">+</span></span>
<span>                 <span class="va">Dolomite</span> <span class="op">+</span> <span class="va">Pyrite</span> <span class="op">+</span> <span class="va">Fluorapatite</span> <span class="op">+</span> <span class="va">Barite</span> <span class="op">+</span> <span class="va">Total_Clay</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Rows where Formation starts with "U"</span></span>
<span><span class="va">xrd_Data_U</span> <span class="op">&lt;-</span> <span class="va">XRD_Portage</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_starts.html" class="external-link">str_starts</a></span><span class="op">(</span><span class="va">Formation</span>, <span class="st">"U"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">xrd_Data_U</span>, <span class="st">"Potage_xrd_Utica.csv"</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Rows where Formation starts with "P"</span></span>
<span><span class="va">xrd_Data_P</span> <span class="op">&lt;-</span> <span class="va">XRD_Portage</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_starts.html" class="external-link">str_starts</a></span><span class="op">(</span><span class="va">Formation</span>, <span class="st">"P"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">xrd_Data_P</span>, <span class="st">"Potage_xrd_PP.csv"</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="toc_portage">Toc_Portage<a class="anchor" aria-label="anchor" href="#toc_portage"></a>
</h2>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Toc_Portage</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">"/mnt/vstor/CSE_MSE_RXF131/staging/sdle/geospatial/core_xrf_xrd/XRF_two_core_in1/chaper_3/TOC_data_Portage.csv"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">68</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">3</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">## <span style="font-weight: bold;">Delimiter:</span> ","</span></span>
<span><span class="co">## <span style="color: #BB0000;">chr</span> (1): Formation</span></span>
<span><span class="co">## <span style="color: #00BB00;">dbl</span> (2): Depth_(ft), TOC_(wt.%)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span></code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#View(Toc_Portage)</span></span>
<span></span>
<span></span>
<span><span class="co"># Rows where Formation starts with "U"</span></span>
<span><span class="va">Toc_Data_U</span> <span class="op">&lt;-</span> <span class="va">Toc_Portage</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_starts.html" class="external-link">str_starts</a></span><span class="op">(</span><span class="va">Formation</span>, <span class="st">"U"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">Toc_Data_U</span>, <span class="st">"Potage_TOC_Utica.csv"</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Rows where Formation starts with "P"</span></span>
<span><span class="va">Toc_Data_P</span> <span class="op">&lt;-</span> <span class="va">Toc_Portage</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_starts.html" class="external-link">str_starts</a></span><span class="op">(</span><span class="va">Formation</span>, <span class="st">"P"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">Toc_Data_P</span>, <span class="st">"Potage_TOC_PP.csv"</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="porosity-data">Porosity DATA<a class="anchor" aria-label="anchor" href="#porosity-data"></a>
</h2>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Porosity_Portage</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">"/mnt/vstor/CSE_MSE_RXF131/staging/sdle/geospatial/core_xrf_xrd/XRF_two_core_in1/chaper_3/1oil and core_potage.csv"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">68</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">6</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">## <span style="font-weight: bold;">Delimiter:</span> ","</span></span>
<span><span class="co">## <span style="color: #00BB00;">dbl</span> (6): Depth_ft, Total</span></span>
<span><span class="co">## Dry Grain Density (g/cc), Total Porosity (per off B...</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span></code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#View(Porosity_Portage)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">Porosity_Portage</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Depth_ft"                          "Total\nDry Grain Density (g/cc)"  </span></span>
<span><span class="co">## [3] "Total Porosity (per off BV)\n"     "Total\nWater Saturation (% of PV)"</span></span>
<span><span class="co">## [5] "Total\nGas Saturation (% of PV)"   "Total Oil Saturation  (% of PV)"</span></span></code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Porosity_Portage</span> <span class="op">&lt;-</span> <span class="va">Porosity_Portage</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>Total_Porosity <span class="op">=</span> <span class="va">`Total Porosity (per off BV)\n`</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Porosity_df</span> <span class="op">&lt;-</span> <span class="va">Porosity_Portage</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">Depth_ft</span>, <span class="va">Total_Porosity</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># For Utica interval (from 6143.95 to 6253.52)</span></span>
<span><span class="va">Porosity_Utica</span> <span class="op">&lt;-</span> <span class="va">Porosity_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Depth_ft</span> <span class="op">&gt;=</span> <span class="fl">6143.95</span> <span class="op">&amp;</span> <span class="va">Depth_ft</span> <span class="op">&lt;=</span> <span class="fl">6353.52</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">Porosity_Utica</span>, <span class="st">"Potage_Porosity_Utica.csv"</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># For Point Pleasant (PP) interval (from 6360.37 to 6443.10)</span></span>
<span><span class="va">Porosity_PP</span> <span class="op">&lt;-</span> <span class="va">Porosity_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Depth_ft</span> <span class="op">&gt;=</span> <span class="fl">6360.37</span> <span class="op">&amp;</span> <span class="va">Depth_ft</span> <span class="op">&lt;=</span> <span class="fl">6443.10</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">Porosity_PP</span> , <span class="st">"Potage_Porosity_PP.csv"</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="the-following-code-is-preparing-the-data-for-plotting-reference-plot-of-continuous-xrf-variables-example-ca-si">The following code is preparing the data for plotting, Reference
plot” of continuous XRF variables (example Ca &amp; Si)<a class="anchor" aria-label="anchor" href="#the-following-code-is-preparing-the-data-for-plotting-reference-plot-of-continuous-xrf-variables-example-ca-si"></a>
</h2>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Assuming you have the following libraries loaded</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hadley/reshape" class="external-link">reshape2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Your new_data_with_clusters dataframe should have the Al_wt% and Si_wt% variables</span></span>
<span><span class="co"># and the Depth_ft variable</span></span>
<span></span>
<span><span class="co"># First, melt the data frame so that it is long format for ggplot</span></span>
<span><span class="va">melted_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html" class="external-link">melt</a></span><span class="op">(</span><span class="va">Data_filtered2</span>, id.vars <span class="op">=</span> <span class="st">'Depth'</span>, measure.vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ca_wt%"</span>, <span class="st">"Si_wt%"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#  "Al_wt%", "Si_wt%", "Mg_wt%",  </span></span>
<span></span>
<span><span class="co"># Now, you can split the 'variable' column to separate the variables and well identifiers</span></span>
<span><span class="co"># Note: Assuming your dataframe does not have separate wells and the measurements</span></span>
<span><span class="co"># are in columns Al_wt% and Si_wt%</span></span>
<span><span class="va">melted_data</span><span class="op">$</span><span class="va">Var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"_.*"</span>, <span class="st">""</span>, <span class="va">melted_data</span><span class="op">$</span><span class="va">variable</span><span class="op">)</span></span>
<span><span class="va">melted_data</span><span class="op">$</span><span class="va">Well</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">".*_"</span>, <span class="st">""</span>, <span class="va">melted_data</span><span class="op">$</span><span class="va">variable</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Convert Well to a factor if it's not already</span></span>
<span><span class="va">melted_data</span><span class="op">$</span><span class="va">Well</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">melted_data</span><span class="op">$</span><span class="va">Well</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Now plot with ggplot</span></span>
<span><span class="va">sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">melted_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">value</span>, y<span class="op">=</span><span class="va">Depth</span>, color<span class="op">=</span><span class="va">Var</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_path</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>linetype<span class="op">=</span><span class="va">Var</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">''</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_reverse</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">6335</span>, color <span class="op">=</span> <span class="st">"black"</span>, linetype <span class="op">=</span> <span class="st">"solid"</span>, size <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="co"># Make the line solid and thicker</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">.</span> <span class="op">~</span> <span class="va">Var</span>, scales<span class="op">=</span><span class="st">'free_x'</span><span class="op">)</span><span class="op">+</span> <span class="co"># free scales allow each variable to have its own x scale</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="co"># This will remove the legend # free scales allow each variable to have its own x scale</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Please use `linewidth` instead.</span></span>
<span><span class="co">## <span style="color: #555555;">This warning is displayed once per session.</span></span></span>
<span><span class="co">## <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">## <span style="color: #555555;">generated.</span></span></span></code></pre>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># If you want to see the plot in your R environment</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">sp</span><span class="op">)</span></span></code></pre></div>
<p><img src="getting-started_files/figure-html/unnamed-chunk-8-1.png" class="r-plt" alt="" width="700"></p>
<p>#The following code is prepar the data for ploting, Multi-track plug
plots (TOC, MBI, Clay, Porosity) aligned visually to the XRF depth
range</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load required libraries</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hadley/reshape" class="external-link">reshape2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ========================</span></span>
<span><span class="co"># STEP 1: Prepare DataFrames</span></span>
<span><span class="co"># ========================</span></span>
<span></span>
<span><span class="co"># Ensure they are proper tibbles</span></span>
<span><span class="va">Porosity_Portage</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="va">Porosity_Portage</span><span class="op">)</span></span>
<span><span class="va">Toc_Portage</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="va">Toc_Portage</span><span class="op">)</span></span>
<span><span class="va">XRD_Portage</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="va">XRD_Portage</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Rename Depth_ft to Depth and select required columns</span></span>
<span><span class="va">porosity_df</span> <span class="op">&lt;-</span> <span class="va">Porosity_Portage</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>Depth <span class="op">=</span> <span class="va">Depth_ft</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">Depth</span>, Porosity <span class="op">=</span> <span class="va">Total_Porosity</span><span class="op">)</span></span>
<span></span>
<span><span class="va">toc_df</span> <span class="op">&lt;-</span> <span class="va">Toc_Portage</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename_with</a></span><span class="op">(</span><span class="op">~</span> <span class="st">"Depth"</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains</a></span><span class="op">(</span><span class="st">"Depth"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>TOC <span class="op">=</span> <span class="va">`TOC_(wt.%)`</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">Depth</span>, <span class="va">TOC</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">mbi_df</span> <span class="op">&lt;-</span> <span class="va">XRD_Portage</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>Depth <span class="op">=</span> <span class="va">Depth_ft</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">Depth</span>, <span class="va">MBI</span><span class="op">)</span></span>
<span></span>
<span><span class="va">TotalClay_df</span> <span class="op">&lt;-</span> <span class="va">XRD_Portage</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>Depth <span class="op">=</span> <span class="va">Depth_ft</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">Depth</span>, <span class="va">Total_Clay</span><span class="op">)</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="co"># Make sure column names are correct</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">porosity_df</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Depth"    "Porosity"</span></span></code></pre>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Should include "Total_Porosity" and "DEPT"</span></span>
<span></span>
<span><span class="co"># Create the plot and store in a different object</span></span>
<span><span class="va">porosity_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">porosity_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Porosity</span>, y <span class="op">=</span> <span class="va">Depth</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_path</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_reverse</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">melted_data</span><span class="op">$</span><span class="va">Depth</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">""</span>, x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">6335</span>, color <span class="op">=</span> <span class="st">"black"</span>, linetype <span class="op">=</span> <span class="st">"solid"</span>, size <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>    axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.ticks.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    strip.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    strip.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">.</span> <span class="op">~</span> <span class="st">"Porosity"</span>, scales <span class="op">=</span> <span class="st">'free_x'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Now print the plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">porosity_plot</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 9 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_point()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 9 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_path()`).</span></span></code></pre>
<p><img src="getting-started_files/figure-html/unnamed-chunk-9-1.png" class="r-plt" alt="" width="700"></p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Make sure column names are correct</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">TotalClay_df</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Depth"      "Total_Clay"</span></span></code></pre>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Should include "Total_Porosity" and "DEPT"</span></span>
<span></span>
<span><span class="co"># Create the plot and store in a different object</span></span>
<span><span class="va">TotalClay</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">TotalClay_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Total_Clay</span>, y <span class="op">=</span> <span class="va">Depth</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_path</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_reverse</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">melted_data</span><span class="op">$</span><span class="va">Depth</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">""</span>, x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">6335</span>, color <span class="op">=</span> <span class="st">"black"</span>, linetype <span class="op">=</span> <span class="st">"solid"</span>, size <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>    axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.ticks.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    strip.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    strip.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">.</span> <span class="op">~</span> <span class="st">"Total_Clay"</span>, scales <span class="op">=</span> <span class="st">'free_x'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Now print the plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">TotalClay</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 2 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_point()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 2 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_path()`).</span></span></code></pre>
<p><img src="getting-started_files/figure-html/unnamed-chunk-9-2.png" class="r-plt" alt="" width="700"></p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Make sure column names are correct</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mbi_df</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Depth" "MBI"</span></span></code></pre>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Should include "Total_Porosity" and "DEPT"</span></span>
<span></span>
<span><span class="co"># Create the plot and store in a different object</span></span>
<span><span class="va">MBI_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">mbi_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">MBI</span>, y <span class="op">=</span> <span class="va">Depth</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_path</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span></span>
<span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_reverse</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">melted_data</span><span class="op">$</span><span class="va">Depth</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">""</span>, x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">6335</span>, color <span class="op">=</span> <span class="st">"black"</span>, linetype <span class="op">=</span> <span class="st">"solid"</span>, size <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>    axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.ticks.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    strip.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    strip.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">.</span> <span class="op">~</span> <span class="st">"MBI"</span>, scales <span class="op">=</span> <span class="st">'free_x'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Now print the plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">MBI_plot</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 2 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_point()`).</span></span>
<span><span class="co">## Removed 2 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_path()`).</span></span></code></pre>
<p><img src="getting-started_files/figure-html/unnamed-chunk-9-3.png" class="r-plt" alt="" width="700"></p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create the plot and store in a different object</span></span>
<span><span class="va">toc_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">toc_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">TOC</span>, y <span class="op">=</span> <span class="va">Depth</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_path</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_reverse</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">melted_data</span><span class="op">$</span><span class="va">Depth</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">""</span>, x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">6335</span>, color <span class="op">=</span> <span class="st">"black"</span>, linetype <span class="op">=</span> <span class="st">"solid"</span>, size <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>    axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.ticks.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    strip.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    strip.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">.</span> <span class="op">~</span> <span class="st">"TOC"</span>, scales <span class="op">=</span> <span class="st">'free_x'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Now print the plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">toc_plot</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 9 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_point()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 9 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_path()`).</span></span></code></pre>
<p><img src="getting-started_files/figure-html/unnamed-chunk-9-4.png" class="r-plt" alt="" width="700"></p>
</div>
<div class="section level2">
<h2 id="chemofacies-colorslabels-combined-panel-tracks-facies-tile">Chemofacies colors/labels + combined panel (tracks + facies
tile)<a class="anchor" aria-label="anchor" href="#chemofacies-colorslabels-combined-panel-tracks-facies-tile"></a>
</h2>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hadley/reshape" class="external-link">reshape2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define colors for each cluster</span></span>
<span><span class="va">facies_colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"1"</span> <span class="op">=</span> <span class="st">"#666666"</span>,  <span class="co"># Color for chemofacies 1</span></span>
<span>  <span class="st">"2"</span> <span class="op">=</span> <span class="st">"#CC9933"</span>,  <span class="co"># Color for chemofacies 2</span></span>
<span>  <span class="st">"3"</span> <span class="op">=</span> <span class="st">"#1B9E77"</span>,  <span class="co"># Color for chemofacies 3</span></span>
<span>  <span class="st">"4"</span> <span class="op">=</span> <span class="st">"#7570B3"</span>,  <span class="co"># Color for chemofacies 4</span></span>
<span>  <span class="st">"5"</span> <span class="op">=</span> <span class="st">"#66A61E"</span>   <span class="co"># Color for chemofacies 5</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define label mapping for display</span></span>
<span><span class="va">chemofacies_labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"1"</span> <span class="op">=</span> <span class="st">"Detrital Dolomitic"</span>,</span>
<span>  <span class="st">"2"</span> <span class="op">=</span> <span class="st">"Siliceous Argillaceous"</span>,</span>
<span>  <span class="st">"3"</span> <span class="op">=</span> <span class="st">"Mixed Silica-Argillaceous"</span>,</span>
<span>  <span class="st">"4"</span> <span class="op">=</span> <span class="st">"Carbonate-Dominated"</span>,</span>
<span>  <span class="st">"5"</span> <span class="op">=</span> <span class="st">"Molybdenum-Rich Anoxic"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># -------------------------------------------------------</span></span>
<span><span class="co"># Formation boundary depth (same line used everywhere)</span></span>
<span><span class="co"># -------------------------------------------------------</span></span>
<span><span class="va">yline</span> <span class="op">&lt;-</span> <span class="fl">6335</span></span>
<span></span>
<span><span class="co"># Assuming `new_data_with_clusters` and `melted_data` are already prepared</span></span>
<span></span>
<span><span class="co"># Define the plot for the chemical data</span></span>
<span><span class="va">chemical_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">melted_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span>, y <span class="op">=</span> <span class="va">Depth</span>, color <span class="op">=</span> <span class="va">Var</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_path</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>linetype <span class="op">=</span> <span class="va">Var</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_reverse</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">melted_data</span><span class="op">$</span><span class="va">Depth</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">Var</span>, scales <span class="op">=</span> <span class="st">"free_x"</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    strip.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    strip.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>    axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.ticks.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.spacing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="st">"lines"</span><span class="op">)</span>,</span>
<span>    panel.border <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"none"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Define the plot for the cluster data</span></span>
<span><span class="va">cluster_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">Data_filtered2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">Depth</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">chemofacies</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">1</span>, height <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">facies_colors</span>, labels <span class="op">=</span> <span class="va">chemofacies_labels</span>, name <span class="op">=</span> <span class="st">"chemofacies"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_reverse</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">melted_data</span><span class="op">$</span><span class="va">Depth</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">yline</span>, color <span class="op">=</span> <span class="st">"black"</span>, linetype <span class="op">=</span> <span class="st">"solid"</span>, size <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"chemofacies"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"right"</span>,</span>
<span>    panel.border <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"chemofacies"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># -------------------------------------------------------</span></span>
<span><span class="co"># Formation label panel (LEFT side): Utica vs Point Pleasant</span></span>
<span><span class="co"># -------------------------------------------------------</span></span>
<span><span class="va">ymin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">melted_data</span><span class="op">$</span><span class="va">Depth</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">ymax</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">melted_data</span><span class="op">$</span><span class="va">Depth</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">utica_mid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">ymin</span>, <span class="va">yline</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pp_mid</span>    <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">yline</span>, <span class="va">ymax</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">formation_panel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span></span>
<span>    <span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">1</span>, y <span class="op">=</span> <span class="va">utica_mid</span>, label <span class="op">=</span> <span class="st">"Utica Fm"</span>,</span>
<span>    angle <span class="op">=</span> <span class="fl">90</span>, fontface <span class="op">=</span> <span class="st">"bold"</span>, size <span class="op">=</span> <span class="fl">3</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span></span>
<span>    <span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">1</span>, y <span class="op">=</span> <span class="va">pp_mid</span>, label <span class="op">=</span> <span class="st">"Point Pleasant Fm"</span>,</span>
<span>    angle <span class="op">=</span> <span class="fl">90</span>, fontface <span class="op">=</span> <span class="st">"bold"</span>, size <span class="op">=</span> <span class="fl">3</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">#geom_hline(yintercept = yline, linewidth = 0.8, color = "black") +</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_reverse</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">ymax</span>, <span class="va">ymin</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">xlim</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># -------------------------------------------------------</span></span>
<span><span class="co"># Combine the plots using patchwork</span></span>
<span><span class="co"># NOTE: sp, toc_plot, MBI_plot, TotalClay, porosity_plot must already exist</span></span>
<span><span class="co"># -------------------------------------------------------</span></span>
<span><span class="va">combined_plot</span> <span class="op">&lt;-</span> <span class="va">formation_panel</span> <span class="op">+</span> <span class="va">sp</span> <span class="op">+</span> <span class="va">toc_plot</span> <span class="op">+</span> <span class="va">MBI_plot</span> <span class="op">+</span> <span class="va">TotalClay</span> <span class="op">+</span> <span class="va">porosity_plot</span> <span class="op">+</span> <span class="va">cluster_plot</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.08</span>, <span class="fl">0.30</span>, <span class="fl">0.10</span>, <span class="fl">0.10</span>, <span class="fl">0.10</span>, <span class="fl">0.10</span>, <span class="fl">0.12</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print the combined plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">combined_plot</span><span class="op">)</span></span></code></pre></div>
<p><img src="getting-started_files/figure-html/unnamed-chunk-10-1.png" class="r-plt" alt="" width="700"></p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Save the combined plot with desired dimensions</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="st">"combined_chemical_cluster_plot1_Potage.png"</span>, <span class="va">combined_plot</span>, width <span class="op">=</span> <span class="fl">10</span>, height <span class="op">=</span> <span class="fl">5</span>, dpi <span class="op">=</span> <span class="fl">300</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="spaalign-alignment-utica-how-to-document-the-why--each-formation-is-done-separately">SpaAlign alignment (Utica) + how to document the “why”. Each
formation is done separately<a class="anchor" aria-label="anchor" href="#spaalign-alignment-utica-how-to-document-the-why--each-formation-is-done-separately"></a>
</h2>
<p>Rationale: XRF is high-resolution and continuous downcore, so we use
it as the vertical reference grid. Plug-based datasets (TOC, Porosity,
XRD) are sparse and sampled at irregular depths.</p>
<p>spa_align() interpolates the sparse plug measurements onto the XRF
depth grid so all variables share the same Depth values. This: -
preserves stratigraphic order, - enables consistent multi-track plots, -
allows facies comparisons and statistics at common depths.</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Read</span></span>
<span><span class="va">xrf_df</span>      <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">"Potage_xrf_Utica.csv"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">412</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">26</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">## <span style="font-weight: bold;">Delimiter:</span> ","</span></span>
<span><span class="co">## <span style="color: #BB0000;">chr</span>  (1): Formation</span></span>
<span><span class="co">## <span style="color: #00BB00;">dbl</span> (25): Depth, Al_wt%, Si_wt%, K_wt%, Ti_wt%, Fe_wt%, S_wt%, Mg_wt%, Ca_wt...</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span></code></pre>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">toc_df</span>      <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">"Potage_TOC_Utica.csv"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">41</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">3</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">## <span style="font-weight: bold;">Delimiter:</span> ","</span></span>
<span><span class="co">## <span style="color: #BB0000;">chr</span> (1): Formation</span></span>
<span><span class="co">## <span style="color: #00BB00;">dbl</span> (2): Depth_(ft), TOC_(wt.%)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span></code></pre>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">porosity_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">"Potage_Porosity_Utica.csv"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">41</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">2</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">## <span style="font-weight: bold;">Delimiter:</span> ","</span></span>
<span><span class="co">## <span style="color: #00BB00;">dbl</span> (2): Depth_ft, Total_Porosity</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span></code></pre>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xrd_df</span>      <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">"Potage_xrd_Utica.csv"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">21</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">14</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">## <span style="font-weight: bold;">Delimiter:</span> ","</span></span>
<span><span class="co">## <span style="color: #BB0000;">chr</span>  (1): Formation</span></span>
<span><span class="co">## <span style="color: #00BB00;">dbl</span> (13): Depth_ft, Quartz, Plagioclase, K-Feldspar, Calcite, Siderite, Anke...</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span></code></pre>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Standardize depth names</span></span>
<span><span class="va">xrf_df</span>      <span class="op">&lt;-</span> <span class="va">xrf_df</span>      <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>Depth <span class="op">=</span> <span class="va">Depth</span><span class="op">)</span>          <span class="co"># (already Depth in your xrf)</span></span>
<span><span class="va">toc_df</span>      <span class="op">&lt;-</span> <span class="va">toc_df</span>      <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>Depth <span class="op">=</span> <span class="va">`Depth_(ft)`</span><span class="op">)</span></span>
<span><span class="va">porosity_df</span> <span class="op">&lt;-</span> <span class="va">porosity_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>Depth <span class="op">=</span> <span class="va">Depth_ft</span><span class="op">)</span></span>
<span><span class="va">xrd_df</span>      <span class="op">&lt;-</span> <span class="va">xrd_df</span>      <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>Depth <span class="op">=</span> <span class="va">Depth_ft</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Keep only what you need + UNIQUE variable names</span></span>
<span><span class="va">toc_df</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">toc_df</span>, <span class="va">Depth</span>, TOC_wt <span class="op">=</span> <span class="va">`TOC_(wt.%)`</span><span class="op">)</span></span>
<span><span class="va">porosity_df</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">porosity_df</span>, <span class="va">Depth</span>, Porosity_total <span class="op">=</span> <span class="va">Total_Porosity</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Remove Formation if present</span></span>
<span><span class="va">xrf_df</span> <span class="op">&lt;-</span> <span class="va">xrf_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">any_of</a></span><span class="op">(</span><span class="st">"Formation"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">xrd_df</span> <span class="op">&lt;-</span> <span class="va">xrd_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">any_of</a></span><span class="op">(</span><span class="st">"Formation"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Sort</span></span>
<span><span class="va">xrf_df</span>      <span class="op">&lt;-</span> <span class="va">xrf_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">Depth</span><span class="op">)</span></span>
<span><span class="va">toc_df</span>      <span class="op">&lt;-</span> <span class="va">toc_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">Depth</span><span class="op">)</span></span>
<span><span class="va">porosity_df</span> <span class="op">&lt;-</span> <span class="va">porosity_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">Depth</span><span class="op">)</span></span>
<span><span class="va">xrd_df</span>      <span class="op">&lt;-</span> <span class="va">xrd_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">Depth</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Align sparse datasets to XRF depth grid</span></span>
<span><span class="va">spaAlign</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spa_align.html">spa_align</a></span><span class="op">(</span></span>
<span>  ref        <span class="op">=</span> <span class="va">xrf_df</span>,</span>
<span>  toc        <span class="op">=</span> <span class="va">toc_df</span>,</span>
<span>  porosity   <span class="op">=</span> <span class="va">porosity_df</span>,</span>
<span>  xrd        <span class="op">=</span> <span class="va">xrd_df</span>,</span>
<span>  depth_col  <span class="op">=</span> <span class="st">"Depth"</span>,</span>
<span>  rule       <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  add_suffix <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  trim       <span class="op">=</span> <span class="cn">FALSE</span> <span class="co"># optionally restrict to overlap-only region</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">spaAlign</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "Depth"                   "Al_wt%"                 </span></span>
<span><span class="co">##  [3] "Si_wt%"                  "K_wt%"                  </span></span>
<span><span class="co">##  [5] "Ti_wt%"                  "Fe_wt%"                 </span></span>
<span><span class="co">##  [7] "S_wt%"                   "Mg_wt%"                 </span></span>
<span><span class="co">##  [9] "Ca_wt%"                  "Sr_wt%"                 </span></span>
<span><span class="co">## [11] "P_wt%"                   "Mo_ppm"                 </span></span>
<span><span class="co">## [13] "V_ppm"                   "U_ppm"                  </span></span>
<span><span class="co">## [15] "Ni_ppm"                  "Cu_ppm"                 </span></span>
<span><span class="co">## [17] "Zn_ppm"                  "Th_ppm"                 </span></span>
<span><span class="co">## [19] "Rb_ppm"                  "Zr_ppm"                 </span></span>
<span><span class="co">## [21] "Pb_ppm"                  "chemofacies"            </span></span>
<span><span class="co">## [23] "Factor1"                 "Factor2"                </span></span>
<span><span class="co">## [25] "Factor3"                 "TOC_wt_toc"             </span></span>
<span><span class="co">## [27] "Porosity_total_porosity" "Quartz_xrd"             </span></span>
<span><span class="co">## [29] "Plagioclase_xrd"         "K-Feldspar_xrd"         </span></span>
<span><span class="co">## [31] "Calcite_xrd"             "Siderite_xrd"           </span></span>
<span><span class="co">## [33] "Ankerite_xrd"            "Dolomite_xrd"           </span></span>
<span><span class="co">## [35] "Pyrite_xrd"              "Fluorapatite_xrd"       </span></span>
<span><span class="co">## [37] "Barite_xrd"              "Total_Clay_xrd"         </span></span>
<span><span class="co">## [39] "MBI_xrd"</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="how-to-verify-whether-trim-is-actually-doing-anything">How to verify whether trim is actually doing anything<a class="anchor" aria-label="anchor" href="#how-to-verify-whether-trim-is-actually-doing-anything"></a>
</h2>
<p>QC: Does trim change anything?</p>
<p>trim = FALSE: keep full reference depth grid; values outside plug
ranges become NA. trim = TRUE: restrict output to depth interval where
datasets overlap (fewer rows, fewer NAs).</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spa_F</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spa_align.html">spa_align</a></span><span class="op">(</span>ref<span class="op">=</span><span class="va">xrf_df</span>, toc<span class="op">=</span><span class="va">toc_df</span>, porosity<span class="op">=</span><span class="va">porosity_df</span>, xrd<span class="op">=</span><span class="va">xrd_df</span>,</span>
<span>                   depth_col<span class="op">=</span><span class="st">"Depth"</span>, rule<span class="op">=</span><span class="fl">1</span>, add_suffix<span class="op">=</span><span class="cn">TRUE</span>, trim<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">spa_T</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spa_align.html">spa_align</a></span><span class="op">(</span>ref<span class="op">=</span><span class="va">xrf_df</span>, toc<span class="op">=</span><span class="va">toc_df</span>, porosity<span class="op">=</span><span class="va">porosity_df</span>, xrd<span class="op">=</span><span class="va">xrd_df</span>,</span>
<span>                   depth_col<span class="op">=</span><span class="st">"Depth"</span>, rule<span class="op">=</span><span class="fl">1</span>, add_suffix<span class="op">=</span><span class="cn">TRUE</span>, trim<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">spa_F</span><span class="op">$</span><span class="va">Depth</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 6141.0 6335.6</span></span></code></pre>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">spa_T</span><span class="op">$</span><span class="va">Depth</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 6144.0 6335.6</span></span></code></pre>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">spa_F</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 412</span></span></code></pre>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">spa_T</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 406</span></span></code></pre>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># how many NAs in key columns</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">spa_F</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TOC_wt_toc"</span>,<span class="st">"Porosity_total_porosity"</span>,<span class="st">"Total_Clay_xrd"</span>,<span class="st">"MBI_xrd"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##              TOC_wt_toc Porosity_total_porosity          Total_Clay_xrd </span></span>
<span><span class="co">##                       6                       6                       3 </span></span>
<span><span class="co">##                 MBI_xrd </span></span>
<span><span class="co">##                       3</span></span></code></pre>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">spa_T</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TOC_wt_toc"</span>,<span class="st">"Porosity_total_porosity"</span>,<span class="st">"Total_Clay_xrd"</span>,<span class="st">"MBI_xrd"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##              TOC_wt_toc Porosity_total_porosity          Total_Clay_xrd </span></span>
<span><span class="co">##                       0                       0                       0 </span></span>
<span><span class="co">##                 MBI_xrd </span></span>
<span><span class="co">##                       0</span></span></code></pre>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">spaAlign</span><span class="op">$</span><span class="va">TOC_wt_toc</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    Mode   FALSE    TRUE </span></span>
<span><span class="co">## logical     406       6</span></span></code></pre>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">spaAlign</span><span class="op">$</span><span class="va">Porosity_total_porosity</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    Mode   FALSE    TRUE </span></span>
<span><span class="co">## logical     406       6</span></span></code></pre>
<div class="section level3">
<h3 id="plot-helpers-track-style-plots">Plot helpers (track-style plots)<a class="anchor" aria-label="anchor" href="#plot-helpers-track-style-plots"></a>
</h3>
</div>
</div>
<div class="section level2">
<h2 id="purpose">Purpose:<a class="anchor" aria-label="anchor" href="#purpose"></a>
</h2>
<ul>
<li>Create consistent “well-log style” panels (variable vs Depth)</li>
<li>Shared theme, shared y-limits, shared formation marker line #
Notes:</li>
<li>make_line_track(): for continuous variables (XRF)</li>
<li>make_point_track(): for sparse/interpolated plug variables
(TOC/porosity/XRD)</li>
</ul>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://scales.r-lib.org" class="external-link">scales</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'scales'</span></span></code></pre>
<pre><code><span><span class="co">## The following object is masked from 'package:readr':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     col_factor</span></span></code></pre>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ----- Column map</span></span>
<span><span class="va">cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  depth      <span class="op">=</span> <span class="st">"Depth"</span>,</span>
<span>  ca         <span class="op">=</span> <span class="st">"Ca_wt%"</span>,</span>
<span>  si         <span class="op">=</span> <span class="st">"Si_wt%"</span>,</span>
<span>  toc        <span class="op">=</span> <span class="st">"TOC_wt_toc"</span>,</span>
<span>  porosity   <span class="op">=</span> <span class="st">"Porosity_total_porosity"</span>,</span>
<span>  total_clay <span class="op">=</span> <span class="st">"Total_Clay_xrd"</span>,</span>
<span>  mbi        <span class="op">=</span> <span class="st">"MBI_xrd"</span>,</span>
<span>  facies     <span class="op">=</span> <span class="st">"chemofacies"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Colors + labels</span></span>
<span><span class="va">facies_colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"1"</span> <span class="op">=</span> <span class="st">"#666666"</span>,</span>
<span>  <span class="st">"2"</span> <span class="op">=</span> <span class="st">"#CC9933"</span>,</span>
<span>  <span class="st">"3"</span> <span class="op">=</span> <span class="st">"#1B9E77"</span>,</span>
<span>  <span class="st">"4"</span> <span class="op">=</span> <span class="st">"#7570B3"</span>,</span>
<span>  <span class="st">"5"</span> <span class="op">=</span> <span class="st">"#66A61E"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">chemofacies_labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"1"</span> <span class="op">=</span> <span class="st">"Detrital Dolomitic"</span>,</span>
<span>  <span class="st">"2"</span> <span class="op">=</span> <span class="st">"Siliceous Argillaceous"</span>,</span>
<span>  <span class="st">"3"</span> <span class="op">=</span> <span class="st">"Mixed Silica-Argillaceous"</span>,</span>
<span>  <span class="st">"4"</span> <span class="op">=</span> <span class="st">"Carbonate-Dominated"</span>,</span>
<span>  <span class="st">"5"</span> <span class="op">=</span> <span class="st">"Molybdenum-Rich Anoxic"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ----- Common settings</span></span>
<span><span class="va">depth_col</span> <span class="op">&lt;-</span> <span class="va">cols</span><span class="op">$</span><span class="va">depth</span></span>
<span><span class="va">ylims</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">spaAlign</span><span class="op">[[</span><span class="va">depth_col</span><span class="op">]</span><span class="op">]</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">yline</span> <span class="op">&lt;-</span> <span class="fl">6335</span>  <span class="co"># optional</span></span>
<span></span>
<span><span class="va">track_theme</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    plot.title      <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span>, size <span class="op">=</span> <span class="fl">11</span><span class="op">)</span>,</span>
<span>    axis.title.x    <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.border    <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span>,</span>
<span>    panel.grid.major.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span>,</span>
<span>    panel.grid.minor.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>    plot.margin     <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># -------------------------------------------------------</span></span>
<span><span class="co"># KEY CHANGE: we control x breaks + label rounding here</span></span>
<span><span class="co"># -------------------------------------------------------</span></span>
<span><span class="va">make_line_track</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span>, <span class="va">xcol</span>, <span class="va">title</span>,</span>
<span>                            <span class="va">col</span> <span class="op">=</span> <span class="st">"black"</span>, <span class="va">lty</span> <span class="op">=</span> <span class="st">"solid"</span>,</span>
<span>                            <span class="va">nbreaks</span> <span class="op">=</span> <span class="fl">4</span>, <span class="va">accuracy</span> <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                            <span class="va">angle</span> <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.data</span><span class="op">[[</span><span class="va">xcol</span><span class="op">]</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">.data</span><span class="op">[[</span><span class="va">depth_col</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_path</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">col</span>, linewidth <span class="op">=</span> <span class="fl">0.6</span>, linetype <span class="op">=</span> <span class="va">lty</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">yline</span>, color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_reverse</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">ylims</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span></span>
<span>      breaks <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/pretty_breaks.html" class="external-link">pretty_breaks</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">nbreaks</span><span class="op">)</span>,</span>
<span>      labels <span class="op">=</span> <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">accuracy</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_number</a></span><span class="op">(</span>accuracy <span class="op">=</span> <span class="va">accuracy</span>, trim <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="kw">else</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/waiver.html" class="external-link">waiver</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="va">title</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">track_theme</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>      axis.text.x  <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span>, angle <span class="op">=</span> <span class="va">angle</span>, hjust <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">angle</span> <span class="op">==</span> <span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">9</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">make_point_track</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span>, <span class="va">xcol</span>, <span class="va">title</span>,</span>
<span>                             <span class="va">nbreaks</span> <span class="op">=</span> <span class="fl">4</span>, <span class="va">accuracy</span> <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                             <span class="va">angle</span> <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.data</span><span class="op">[[</span><span class="va">xcol</span><span class="op">]</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">.data</span><span class="op">[[</span><span class="va">depth_col</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_path</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">yline</span>, color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_reverse</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">ylims</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span></span>
<span>      breaks <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/pretty_breaks.html" class="external-link">pretty_breaks</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">nbreaks</span><span class="op">)</span>,</span>
<span>      labels <span class="op">=</span> <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">accuracy</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_number</a></span><span class="op">(</span>accuracy <span class="op">=</span> <span class="va">accuracy</span>, trim <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="kw">else</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/waiver.html" class="external-link">waiver</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="va">title</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">track_theme</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>      axis.text.x  <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span>, angle <span class="op">=</span> <span class="va">angle</span>, hjust <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">angle</span> <span class="op">==</span> <span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># ----- Tracks (only Porosity needs the special formatting)</span></span>
<span><span class="va">ca_plot</span>       <span class="op">&lt;-</span> <span class="fu">make_line_track</span><span class="op">(</span><span class="va">spaAlign</span>, <span class="va">cols</span><span class="op">$</span><span class="va">ca</span>, <span class="st">"Ca"</span>, col <span class="op">=</span> <span class="st">"salmon"</span>, nbreaks <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">si_plot</span>       <span class="op">&lt;-</span> <span class="fu">make_line_track</span><span class="op">(</span><span class="va">spaAlign</span>, <span class="va">cols</span><span class="op">$</span><span class="va">si</span>, <span class="st">"Si"</span>, col <span class="op">=</span> <span class="st">"deepskyblue3"</span>, lty <span class="op">=</span> <span class="st">"dashed"</span>, nbreaks <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">toc_plot</span>      <span class="op">&lt;-</span> <span class="fu">make_point_track</span><span class="op">(</span><span class="va">spaAlign</span>, <span class="va">cols</span><span class="op">$</span><span class="va">toc</span>, <span class="st">"TOC (wt.%)"</span>, nbreaks <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">mbi_plot</span>      <span class="op">&lt;-</span> <span class="fu">make_point_track</span><span class="op">(</span><span class="va">spaAlign</span>, <span class="va">cols</span><span class="op">$</span><span class="va">mbi</span>, <span class="st">"MBI"</span>, nbreaks <span class="op">=</span> <span class="fl">3</span>, accuracy <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span>     <span class="co"># optional tidy</span></span>
<span><span class="va">clay_plot</span>     <span class="op">&lt;-</span> <span class="fu">make_point_track</span><span class="op">(</span><span class="va">spaAlign</span>, <span class="va">cols</span><span class="op">$</span><span class="va">total_clay</span>, <span class="st">"Total_Clay"</span>, nbreaks <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># IMPORTANT: Porosity — fewer ticks + rounded labels + slight angle</span></span>
<span><span class="va">porosity_plot</span> <span class="op">&lt;-</span> <span class="fu">make_point_track</span><span class="op">(</span></span>
<span>  <span class="va">spaAlign</span>, <span class="va">cols</span><span class="op">$</span><span class="va">porosity</span>, <span class="st">"Porosity"</span>,</span>
<span>  nbreaks <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  accuracy <span class="op">=</span> <span class="fl">0.005</span>,</span>
<span>  angle <span class="op">=</span> <span class="fl">45</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Facies tile track</span></span>
<span><span class="va">cluster_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">spaAlign</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, y <span class="op">=</span> <span class="va">.data</span><span class="op">[[</span><span class="va">depth_col</span><span class="op">]</span><span class="op">]</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">.data</span><span class="op">[[</span><span class="va">cols</span><span class="op">$</span><span class="va">facies</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">1</span>, height <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">yline</span>, color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_reverse</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">ylims</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">facies_colors</span>, labels <span class="op">=</span> <span class="va">chemofacies_labels</span>, name <span class="op">=</span> <span class="st">"chemofacies"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"chemofacies"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span>, size <span class="op">=</span> <span class="fl">11</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"right"</span>,</span>
<span>    panel.border <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span>,</span>
<span>    plot.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Formation label panel (Utica only)</span></span>
<span><span class="va">utica_panel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>,</span>
<span>           x <span class="op">=</span> <span class="fl">1</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">ylims</span><span class="op">)</span>,</span>
<span>           label <span class="op">=</span> <span class="st">"Utica Fm"</span>,</span>
<span>           angle <span class="op">=</span> <span class="fl">90</span>, fontface <span class="op">=</span> <span class="st">"bold"</span>, size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_reverse</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">ylims</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">xlim</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ----- Combine</span></span>
<span><span class="va">combined_plot</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">utica_panel</span> <span class="op">+</span> <span class="va">ca_plot</span> <span class="op">+</span> <span class="va">si_plot</span> <span class="op">+</span> <span class="va">toc_plot</span> <span class="op">+</span> <span class="va">mbi_plot</span> <span class="op">+</span> <span class="va">clay_plot</span> <span class="op">+</span> <span class="va">porosity_plot</span> <span class="op">+</span> <span class="va">cluster_plot</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.08</span>, <span class="fl">0.12</span>, <span class="fl">0.12</span>, <span class="fl">0.12</span>, <span class="fl">0.12</span>, <span class="fl">0.12</span>, <span class="fl">0.14</span>, <span class="fl">0.16</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">combined_plot</span><span class="op">)</span></span></code></pre></div>
<p><img src="getting-started_files/figure-html/unnamed-chunk-13-1.png" class="r-plt" alt="" width="700"></p>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Save wider so ticks have space (this also helps a lot)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="st">"combined_tracks_chemofacies.png"</span>, <span class="va">combined_plot</span>, width <span class="op">=</span> <span class="fl">12</span>, height <span class="op">=</span> <span class="fl">5</span>, dpi <span class="op">=</span> <span class="fl">300</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="boxplot-by-chemofacies-example-toc">Boxplot by chemofacies (example TOC)<a class="anchor" aria-label="anchor" href="#boxplot-by-chemofacies-example-toc"></a>
</h2>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Assume facies_colors are defined somewhere in your script as before</span></span>
<span><span class="va">facies_colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"1"</span> <span class="op">=</span> <span class="st">"#666666"</span>,  <span class="co"># Color for cluster 1</span></span>
<span>  <span class="st">"2"</span> <span class="op">=</span> <span class="st">"#7570B3"</span>,  <span class="co"># Color for cluster 2</span></span>
<span>  <span class="st">"3"</span> <span class="op">=</span> <span class="st">"#1B9E77"</span>,  <span class="co"># Color for cluster 3</span></span>
<span>  <span class="st">"4"</span> <span class="op">=</span> <span class="st">"#CC9933"</span>,  <span class="co"># Color for cluster 4</span></span>
<span>  <span class="st">"5"</span> <span class="op">=</span> <span class="st">"#66A61E"</span>   <span class="co"># Color for cluster 5</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">chemofacies_labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"1"</span> <span class="op">=</span> <span class="st">"Detrital Dolomitic"</span>,</span>
<span>  <span class="st">"2"</span> <span class="op">=</span> <span class="st">"Siliceous Argillaceous"</span>,</span>
<span>  <span class="st">"3"</span> <span class="op">=</span> <span class="st">"Mixed Silica-Argillaceous"</span>,</span>
<span>  <span class="st">"4"</span> <span class="op">=</span> <span class="st">"Carbonate-Dominated"</span>,</span>
<span>  <span class="st">"5"</span> <span class="op">=</span> <span class="st">"Molybdenum-Rich Anoxic"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">create_plot</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">var</span>, <span class="va">facies_colors</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">spaAlign</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">chemofacies</span><span class="op">)</span>,</span>
<span>                       y <span class="op">=</span> <span class="va">.data</span><span class="op">[[</span><span class="va">var</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                       fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">chemofacies</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span>outlier.color <span class="op">=</span> <span class="st">"red"</span>, outlier.shape <span class="op">=</span> <span class="fl">3</span>, color<span class="op">=</span><span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">stat_boxplot</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"errorbar"</span>, width <span class="op">=</span> <span class="fl">0.25</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">facies_colors</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">18</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="va">var</span>, y <span class="op">=</span> <span class="va">var</span>, x <span class="op">=</span> <span class="st">"chemofacies"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">create_plot</span><span class="op">(</span><span class="st">"TOC_wt_toc"</span>, <span class="va">facies_colors</span><span class="op">)</span></span></code></pre></div>
<p><img src="getting-started_files/figure-html/unnamed-chunk-14-1.png" class="r-plt" alt="" width="700"></p>
</div>
<div class="section level2">
<h2 id="spaalign-alignment-pp-plot-pp-tracks">spaAlign alignment (PP) + plot PP tracks<a class="anchor" aria-label="anchor" href="#spaalign-alignment-pp-plot-pp-tracks"></a>
</h2>
<p>spaAlign: POINT PLEASANT (PP) ALIGNMENT - Same process as Utica, but
using PP subsets.</p>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org" class="external-link">readr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://omodolor.github.io/spaAlign/" class="external-link">spaAlign</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># --- Read (PP)</span></span>
<span><span class="va">xrf_df_PP</span>      <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">"Potage_xrf_PP.csv"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">219</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">26</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">## <span style="font-weight: bold;">Delimiter:</span> ","</span></span>
<span><span class="co">## <span style="color: #BB0000;">chr</span>  (1): Formation</span></span>
<span><span class="co">## <span style="color: #00BB00;">dbl</span> (25): Depth, Al_wt%, Si_wt%, K_wt%, Ti_wt%, Fe_wt%, S_wt%, Mg_wt%, Ca_wt...</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span></code></pre>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">toc_df_PP</span>      <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">"Potage_TOC_PP.csv"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">17</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">3</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">## <span style="font-weight: bold;">Delimiter:</span> ","</span></span>
<span><span class="co">## <span style="color: #BB0000;">chr</span> (1): Formation</span></span>
<span><span class="co">## <span style="color: #00BB00;">dbl</span> (2): Depth_(ft), TOC_(wt.%)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span></code></pre>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">porosity_df_PP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">"Potage_Porosity_PP.csv"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">17</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">2</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">## <span style="font-weight: bold;">Delimiter:</span> ","</span></span>
<span><span class="co">## <span style="color: #00BB00;">dbl</span> (2): Depth_ft, Total_Porosity</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span></code></pre>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xrd_df_PP</span>      <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">"Potage_xrd_PP.csv"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">9</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">14</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">## <span style="font-weight: bold;">Delimiter:</span> ","</span></span>
<span><span class="co">## <span style="color: #BB0000;">chr</span>  (1): Formation</span></span>
<span><span class="co">## <span style="color: #00BB00;">dbl</span> (13): Depth_ft, Quartz, Plagioclase, K-Feldspar, Calcite, Siderite, Anke...</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span></code></pre>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># --- Standardize depth names</span></span>
<span><span class="co"># (XRF already has Depth, but this is safe)</span></span>
<span><span class="va">xrf_df_PP</span>      <span class="op">&lt;-</span> <span class="va">xrf_df_PP</span>      <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>Depth <span class="op">=</span> <span class="va">Depth</span><span class="op">)</span></span>
<span><span class="va">toc_df_PP</span>      <span class="op">&lt;-</span> <span class="va">toc_df_PP</span>      <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>Depth <span class="op">=</span> <span class="va">`Depth_(ft)`</span><span class="op">)</span></span>
<span><span class="va">porosity_df_PP</span> <span class="op">&lt;-</span> <span class="va">porosity_df_PP</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>Depth <span class="op">=</span> <span class="va">Depth_ft</span><span class="op">)</span></span>
<span><span class="va">xrd_df_PP</span>      <span class="op">&lt;-</span> <span class="va">xrd_df_PP</span>      <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>Depth <span class="op">=</span> <span class="va">Depth_ft</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># --- Keep only what you need + UNIQUE variable names</span></span>
<span><span class="va">toc_df_PP</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">toc_df_PP</span>, <span class="va">Depth</span>, TOC_wt <span class="op">=</span> <span class="va">`TOC_(wt.%)`</span><span class="op">)</span></span>
<span><span class="va">porosity_df_PP</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">porosity_df_PP</span>, <span class="va">Depth</span>, Porosity_total <span class="op">=</span> <span class="va">Total_Porosity</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># --- Remove Formation if present</span></span>
<span><span class="va">xrf_df_PP</span> <span class="op">&lt;-</span> <span class="va">xrf_df_PP</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">any_of</a></span><span class="op">(</span><span class="st">"Formation"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">toc_df_PP</span> <span class="op">&lt;-</span> <span class="va">toc_df_PP</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">any_of</a></span><span class="op">(</span><span class="st">"Formation"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">xrd_df_PP</span> <span class="op">&lt;-</span> <span class="va">xrd_df_PP</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">any_of</a></span><span class="op">(</span><span class="st">"Formation"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># --- Sort</span></span>
<span><span class="va">xrf_df_PP</span>      <span class="op">&lt;-</span> <span class="va">xrf_df_PP</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">Depth</span><span class="op">)</span></span>
<span><span class="va">toc_df_PP</span>      <span class="op">&lt;-</span> <span class="va">toc_df_PP</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">Depth</span><span class="op">)</span></span>
<span><span class="va">porosity_df_PP</span> <span class="op">&lt;-</span> <span class="va">porosity_df_PP</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">Depth</span><span class="op">)</span></span>
<span><span class="va">xrd_df_PP</span>      <span class="op">&lt;-</span> <span class="va">xrd_df_PP</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">Depth</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># --- Align</span></span>
<span><span class="va">spaAlign_PP</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spa_align.html">spa_align</a></span><span class="op">(</span></span>
<span>  ref        <span class="op">=</span> <span class="va">xrf_df_PP</span>,</span>
<span>  toc        <span class="op">=</span> <span class="va">toc_df_PP</span>,</span>
<span>  porosity   <span class="op">=</span> <span class="va">porosity_df_PP</span>,</span>
<span>  xrd        <span class="op">=</span> <span class="va">xrd_df_PP</span>,</span>
<span>  depth_col  <span class="op">=</span> <span class="st">"Depth"</span>,</span>
<span>  rule       <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  add_suffix <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  trim       <span class="op">=</span> <span class="cn">FALSE</span>   <span class="co"># or TRUE if you want overlap-only, no NAs</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">spaAlign_PP</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "Depth"                   "Al_wt%"                 </span></span>
<span><span class="co">##  [3] "Si_wt%"                  "K_wt%"                  </span></span>
<span><span class="co">##  [5] "Ti_wt%"                  "Fe_wt%"                 </span></span>
<span><span class="co">##  [7] "S_wt%"                   "Mg_wt%"                 </span></span>
<span><span class="co">##  [9] "Ca_wt%"                  "Sr_wt%"                 </span></span>
<span><span class="co">## [11] "P_wt%"                   "Mo_ppm"                 </span></span>
<span><span class="co">## [13] "V_ppm"                   "U_ppm"                  </span></span>
<span><span class="co">## [15] "Ni_ppm"                  "Cu_ppm"                 </span></span>
<span><span class="co">## [17] "Zn_ppm"                  "Th_ppm"                 </span></span>
<span><span class="co">## [19] "Rb_ppm"                  "Zr_ppm"                 </span></span>
<span><span class="co">## [21] "Pb_ppm"                  "chemofacies"            </span></span>
<span><span class="co">## [23] "Factor1"                 "Factor2"                </span></span>
<span><span class="co">## [25] "Factor3"                 "TOC_wt_toc"             </span></span>
<span><span class="co">## [27] "Porosity_total_porosity" "Quartz_xrd"             </span></span>
<span><span class="co">## [29] "Plagioclase_xrd"         "K-Feldspar_xrd"         </span></span>
<span><span class="co">## [31] "Calcite_xrd"             "Siderite_xrd"           </span></span>
<span><span class="co">## [33] "Ankerite_xrd"            "Dolomite_xrd"           </span></span>
<span><span class="co">## [35] "Pyrite_xrd"              "Fluorapatite_xrd"       </span></span>
<span><span class="co">## [37] "Barite_xrd"              "Total_Clay_xrd"         </span></span>
<span><span class="co">## [39] "MBI_xrd"</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="plot-pp-aligned-tracks">PLOT: PP ALIGNED TRACKS<a class="anchor" aria-label="anchor" href="#plot-pp-aligned-tracks"></a>
</h2>
<ul>
<li>Uses the same helper functions.</li>
<li>If PP marker line differs from Utica, change yline here.</li>
</ul>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://scales.r-lib.org" class="external-link">scales</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ----- Column map (based on your names(spaAlign_PP))</span></span>
<span><span class="va">cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  depth      <span class="op">=</span> <span class="st">"Depth"</span>,</span>
<span>  ca         <span class="op">=</span> <span class="st">"Ca_wt%"</span>,</span>
<span>  si         <span class="op">=</span> <span class="st">"Si_wt%"</span>,</span>
<span>  toc        <span class="op">=</span> <span class="st">"TOC_wt_toc"</span>,</span>
<span>  porosity   <span class="op">=</span> <span class="st">"Porosity_total_porosity"</span>,</span>
<span>  total_clay <span class="op">=</span> <span class="st">"Total_Clay_xrd"</span>,</span>
<span>  mbi        <span class="op">=</span> <span class="st">"MBI_xrd"</span>,</span>
<span>  facies     <span class="op">=</span> <span class="st">"chemofacies"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># quick checks</span></span>
<span><span class="va">cols</span><span class="op">$</span><span class="va">toc</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">spaAlign_PP</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cols</span><span class="op">$</span><span class="va">porosity</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">spaAlign_PP</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cols</span><span class="op">$</span><span class="va">total_clay</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">spaAlign_PP</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cols</span><span class="op">$</span><span class="va">mbi</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">spaAlign_PP</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cols</span><span class="op">$</span><span class="va">facies</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">spaAlign_PP</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Colors + labels</span></span>
<span><span class="va">facies_colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"1"</span> <span class="op">=</span> <span class="st">"#666666"</span>,</span>
<span>  <span class="st">"2"</span> <span class="op">=</span> <span class="st">"#CC9933"</span>,</span>
<span>  <span class="st">"3"</span> <span class="op">=</span> <span class="st">"#1B9E77"</span>,</span>
<span>  <span class="st">"4"</span> <span class="op">=</span> <span class="st">"#7570B3"</span>,</span>
<span>  <span class="st">"5"</span> <span class="op">=</span> <span class="st">"#66A61E"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">chemofacies_labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"1"</span> <span class="op">=</span> <span class="st">"Detrital Dolomitic"</span>,</span>
<span>  <span class="st">"2"</span> <span class="op">=</span> <span class="st">"Siliceous Argillaceous"</span>,</span>
<span>  <span class="st">"3"</span> <span class="op">=</span> <span class="st">"Mixed Silica-Argillaceous"</span>,</span>
<span>  <span class="st">"4"</span> <span class="op">=</span> <span class="st">"Carbonate-Dominated"</span>,</span>
<span>  <span class="st">"5"</span> <span class="op">=</span> <span class="st">"Molybdenum-Rich Anoxic"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ----- Common settings</span></span>
<span><span class="va">depth_col</span> <span class="op">&lt;-</span> <span class="va">cols</span><span class="op">$</span><span class="va">depth</span></span>
<span><span class="va">ylims</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">spaAlign_PP</span><span class="op">[[</span><span class="va">depth_col</span><span class="op">]</span><span class="op">]</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Optional: if you still want a horizontal marker line (otherwise set to NA)</span></span>
<span><span class="va">yline</span> <span class="op">&lt;-</span> <span class="fl">6335</span></span>
<span></span>
<span><span class="va">track_theme</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    plot.title      <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span>, size <span class="op">=</span> <span class="fl">11</span><span class="op">)</span>,</span>
<span>    axis.title.x    <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.border    <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span>,</span>
<span>    panel.grid.major.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span>,</span>
<span>    panel.grid.minor.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>    plot.margin     <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># -------------------------------------------------------</span></span>
<span><span class="co"># KEY CHANGE: control x breaks + label rounding here</span></span>
<span><span class="co"># -------------------------------------------------------</span></span>
<span><span class="va">make_line_track</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span>, <span class="va">xcol</span>, <span class="va">title</span>,</span>
<span>                            <span class="va">col</span> <span class="op">=</span> <span class="st">"black"</span>, <span class="va">lty</span> <span class="op">=</span> <span class="st">"solid"</span>,</span>
<span>                            <span class="va">nbreaks</span> <span class="op">=</span> <span class="fl">4</span>, <span class="va">accuracy</span> <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                            <span class="va">angle</span> <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.data</span><span class="op">[[</span><span class="va">xcol</span><span class="op">]</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">.data</span><span class="op">[[</span><span class="va">depth_col</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_path</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">col</span>, linewidth <span class="op">=</span> <span class="fl">0.6</span>, linetype <span class="op">=</span> <span class="va">lty</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">yline</span>, color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_reverse</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">ylims</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span></span>
<span>      breaks <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/pretty_breaks.html" class="external-link">pretty_breaks</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">nbreaks</span><span class="op">)</span>,</span>
<span>      labels <span class="op">=</span> <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">accuracy</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_number</a></span><span class="op">(</span>accuracy <span class="op">=</span> <span class="va">accuracy</span>, trim <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="kw">else</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/waiver.html" class="external-link">waiver</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="va">title</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">track_theme</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>      axis.text.x  <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span>, angle <span class="op">=</span> <span class="va">angle</span>, hjust <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">angle</span> <span class="op">==</span> <span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">9</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">make_point_track</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span>, <span class="va">xcol</span>, <span class="va">title</span>,</span>
<span>                             <span class="va">nbreaks</span> <span class="op">=</span> <span class="fl">4</span>, <span class="va">accuracy</span> <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                             <span class="va">angle</span> <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.data</span><span class="op">[[</span><span class="va">xcol</span><span class="op">]</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">.data</span><span class="op">[[</span><span class="va">depth_col</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_path</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">yline</span>, color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_reverse</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">ylims</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span></span>
<span>      breaks <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/pretty_breaks.html" class="external-link">pretty_breaks</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">nbreaks</span><span class="op">)</span>,</span>
<span>      labels <span class="op">=</span> <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">accuracy</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_number</a></span><span class="op">(</span>accuracy <span class="op">=</span> <span class="va">accuracy</span>, trim <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="kw">else</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/waiver.html" class="external-link">waiver</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="va">title</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">track_theme</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>      axis.text.x  <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span>, angle <span class="op">=</span> <span class="va">angle</span>, hjust <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">angle</span> <span class="op">==</span> <span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># ----- Tracks</span></span>
<span><span class="va">ca_plot</span>   <span class="op">&lt;-</span> <span class="fu">make_line_track</span><span class="op">(</span><span class="va">spaAlign_PP</span>, <span class="va">cols</span><span class="op">$</span><span class="va">ca</span>, <span class="st">"Ca"</span>, col <span class="op">=</span> <span class="st">"salmon"</span>, nbreaks <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">si_plot</span>   <span class="op">&lt;-</span> <span class="fu">make_line_track</span><span class="op">(</span><span class="va">spaAlign_PP</span>, <span class="va">cols</span><span class="op">$</span><span class="va">si</span>, <span class="st">"Si"</span>, col <span class="op">=</span> <span class="st">"deepskyblue3"</span>, lty <span class="op">=</span> <span class="st">"dashed"</span>, nbreaks <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">toc_plot</span>  <span class="op">&lt;-</span> <span class="fu">make_point_track</span><span class="op">(</span><span class="va">spaAlign_PP</span>, <span class="va">cols</span><span class="op">$</span><span class="va">toc</span>, <span class="st">"TOC (wt.%)"</span>, nbreaks <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">mbi_plot</span>  <span class="op">&lt;-</span> <span class="fu">make_point_track</span><span class="op">(</span><span class="va">spaAlign_PP</span>, <span class="va">cols</span><span class="op">$</span><span class="va">mbi</span>, <span class="st">"MBI"</span>, nbreaks <span class="op">=</span> <span class="fl">3</span>, accuracy <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="va">clay_plot</span> <span class="op">&lt;-</span> <span class="fu">make_point_track</span><span class="op">(</span><span class="va">spaAlign_PP</span>, <span class="va">cols</span><span class="op">$</span><span class="va">total_clay</span>, <span class="st">"Total_Clay"</span>, nbreaks <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># IMPORTANT: Porosity — fewer ticks + rounded labels + slight angle</span></span>
<span><span class="va">porosity_plot</span> <span class="op">&lt;-</span> <span class="fu">make_point_track</span><span class="op">(</span></span>
<span>  <span class="va">spaAlign_PP</span>, <span class="va">cols</span><span class="op">$</span><span class="va">porosity</span>, <span class="st">"Porosity"</span>,</span>
<span>  nbreaks <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  accuracy <span class="op">=</span> <span class="fl">0.005</span>,</span>
<span>  angle <span class="op">=</span> <span class="fl">45</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Facies tile track</span></span>
<span><span class="va">cluster_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">spaAlign_PP</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, y <span class="op">=</span> <span class="va">.data</span><span class="op">[[</span><span class="va">depth_col</span><span class="op">]</span><span class="op">]</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">.data</span><span class="op">[[</span><span class="va">cols</span><span class="op">$</span><span class="va">facies</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">1</span>, height <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">yline</span>, color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_reverse</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">ylims</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">facies_colors</span>, labels <span class="op">=</span> <span class="va">chemofacies_labels</span>, name <span class="op">=</span> <span class="st">"chemofacies"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"chemofacies"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span>, size <span class="op">=</span> <span class="fl">11</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"right"</span>,</span>
<span>    panel.border <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span>,</span>
<span>    plot.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># -------------------------------------------------------</span></span>
<span><span class="co"># NEW: Formation label panel (LEFT side) — Point Pleasant only</span></span>
<span><span class="co"># Put this RIGHT BEFORE you combine the plots</span></span>
<span><span class="co"># -------------------------------------------------------</span></span>
<span><span class="va">pp_panel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span></span>
<span>    <span class="st">"text"</span>,</span>
<span>    x <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">ylims</span><span class="op">)</span>,</span>
<span>    label <span class="op">=</span> <span class="st">"Point Pleasant Fm"</span>,</span>
<span>    angle <span class="op">=</span> <span class="fl">90</span>,</span>
<span>    fontface <span class="op">=</span> <span class="st">"bold"</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">4</span>      <span class="co"># &lt;- adjust text size here</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_reverse</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">ylims</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">xlim</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ----- Combine (added pp_panel at the far LEFT)</span></span>
<span><span class="va">combined_plot_PP</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">pp_panel</span> <span class="op">+</span> <span class="va">ca_plot</span> <span class="op">+</span> <span class="va">si_plot</span> <span class="op">+</span> <span class="va">toc_plot</span> <span class="op">+</span> <span class="va">mbi_plot</span> <span class="op">+</span> <span class="va">clay_plot</span> <span class="op">+</span> <span class="va">porosity_plot</span> <span class="op">+</span> <span class="va">cluster_plot</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.08</span>, <span class="fl">0.12</span>, <span class="fl">0.12</span>, <span class="fl">0.12</span>, <span class="fl">0.12</span>, <span class="fl">0.12</span>, <span class="fl">0.14</span>, <span class="fl">0.16</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">combined_plot_PP</span><span class="op">)</span></span></code></pre></div>
<p><img src="getting-started_files/figure-html/unnamed-chunk-16-1.png" class="r-plt" alt="" width="700"></p>
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Save wider so ticks have space (helps porosity labels a lot)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="st">"combined_tracks_chemofacies_PP.png"</span>, <span class="va">combined_plot_PP</span>, width <span class="op">=</span> <span class="fl">12</span>, height <span class="op">=</span> <span class="fl">5</span>, dpi <span class="op">=</span> <span class="fl">300</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="combine-utica-pp-aligned-tables-into-a-full-core-aligned-table">Combine Utica + PP aligned tables into a full-core aligned
table<a class="anchor" aria-label="anchor" href="#combine-utica-pp-aligned-tables-into-a-full-core-aligned-table"></a>
</h2>
<p>FULL CORE TABLE - Stack spaAlign (Utica) and spaAlign_PP (PP) into
one dataset. - Adds an “Interval” label so you can subset later.</p>
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># make sure dplyr is loaded</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># add interval labels (optional)</span></span>
<span><span class="va">spaAlign</span>    <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">spaAlign</span>, Interval <span class="op">=</span> <span class="st">"Utica"</span><span class="op">)</span></span>
<span><span class="va">spaAlign_PP</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">spaAlign_PP</span>, Interval <span class="op">=</span> <span class="st">"PP"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># union of column names</span></span>
<span><span class="va">all_cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">union</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">spaAlign</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">spaAlign_PP</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># row-bind with identical columns, then sort by Depth</span></span>
<span><span class="va">spaAlign_full</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">spaAlign</span>,    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">all_of</a></span><span class="op">(</span><span class="va">all_cols</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">spaAlign_PP</span>, <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">all_of</a></span><span class="op">(</span><span class="va">all_cols</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">Depth</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># quick checks</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">spaAlign_full</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "Depth"                   "Al_wt%"                 </span></span>
<span><span class="co">##  [3] "Si_wt%"                  "K_wt%"                  </span></span>
<span><span class="co">##  [5] "Ti_wt%"                  "Fe_wt%"                 </span></span>
<span><span class="co">##  [7] "S_wt%"                   "Mg_wt%"                 </span></span>
<span><span class="co">##  [9] "Ca_wt%"                  "Sr_wt%"                 </span></span>
<span><span class="co">## [11] "P_wt%"                   "Mo_ppm"                 </span></span>
<span><span class="co">## [13] "V_ppm"                   "U_ppm"                  </span></span>
<span><span class="co">## [15] "Ni_ppm"                  "Cu_ppm"                 </span></span>
<span><span class="co">## [17] "Zn_ppm"                  "Th_ppm"                 </span></span>
<span><span class="co">## [19] "Rb_ppm"                  "Zr_ppm"                 </span></span>
<span><span class="co">## [21] "Pb_ppm"                  "chemofacies"            </span></span>
<span><span class="co">## [23] "Factor1"                 "Factor2"                </span></span>
<span><span class="co">## [25] "Factor3"                 "TOC_wt_toc"             </span></span>
<span><span class="co">## [27] "Porosity_total_porosity" "Quartz_xrd"             </span></span>
<span><span class="co">## [29] "Plagioclase_xrd"         "K-Feldspar_xrd"         </span></span>
<span><span class="co">## [31] "Calcite_xrd"             "Siderite_xrd"           </span></span>
<span><span class="co">## [33] "Ankerite_xrd"            "Dolomite_xrd"           </span></span>
<span><span class="co">## [35] "Pyrite_xrd"              "Fluorapatite_xrd"       </span></span>
<span><span class="co">## [37] "Barite_xrd"              "Total_Clay_xrd"         </span></span>
<span><span class="co">## [39] "MBI_xrd"                 "Interval"</span></span></code></pre>
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">spaAlign_full</span><span class="op">$</span><span class="va">Depth</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 6141.0 6444.6</span></span></code></pre>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">spaAlign_full</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 631</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="plot-full-core-aligned-tracks-facies">Plot full-core aligned tracks + facies<a class="anchor" aria-label="anchor" href="#plot-full-core-aligned-tracks-facies"></a>
</h2>
<p>PLOT: FULL CORE TRACKS - Rebuild tracks using spaAlign_full. - Uses
same helper functions and styling.</p>
<div class="sourceCode" id="cb108"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Colors + labels</span></span>
<span><span class="va">facies_colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"1"</span> <span class="op">=</span> <span class="st">"#666666"</span>,</span>
<span>  <span class="st">"2"</span> <span class="op">=</span> <span class="st">"#CC9933"</span>,</span>
<span>  <span class="st">"3"</span> <span class="op">=</span> <span class="st">"#1B9E77"</span>,</span>
<span>  <span class="st">"4"</span> <span class="op">=</span> <span class="st">"#7570B3"</span>,</span>
<span>  <span class="st">"5"</span> <span class="op">=</span> <span class="st">"#66A61E"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">chemofacies_labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"1"</span> <span class="op">=</span> <span class="st">"Detrital Dolomitic"</span>,</span>
<span>  <span class="st">"2"</span> <span class="op">=</span> <span class="st">"Siliceous Argillaceous"</span>,</span>
<span>  <span class="st">"3"</span> <span class="op">=</span> <span class="st">"Mixed Silica-Argillaceous"</span>,</span>
<span>  <span class="st">"4"</span> <span class="op">=</span> <span class="st">"Carbonate-Dominated"</span>,</span>
<span>  <span class="st">"5"</span> <span class="op">=</span> <span class="st">"Molybdenum-Rich Anoxic"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 1) depth + y limits (do this BEFORE tracks)</span></span>
<span><span class="va">depth_col</span> <span class="op">&lt;-</span> <span class="va">cols</span><span class="op">$</span><span class="va">depth</span></span>
<span><span class="va">ylims</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">spaAlign_full</span><span class="op">[[</span><span class="va">depth_col</span><span class="op">]</span><span class="op">]</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Formation boundary depth</span></span>
<span><span class="va">yline</span> <span class="op">&lt;-</span> <span class="fl">6335</span>  <span class="co"># your separator</span></span>
<span></span>
<span><span class="co"># -------------------------------------------------------</span></span>
<span><span class="co"># NEW: Formation label panel (LEFT side): Utica vs Point Pleasant</span></span>
<span><span class="co"># Put this BEFORE you combine the plots</span></span>
<span><span class="co"># -------------------------------------------------------</span></span>
<span><span class="va">ymin</span> <span class="op">&lt;-</span> <span class="va">ylims</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">ymax</span> <span class="op">&lt;-</span> <span class="va">ylims</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span></span>
<span><span class="va">utica_mid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">ymin</span>, <span class="va">yline</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pp_mid</span>    <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">yline</span>, <span class="va">ymax</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">formation_panel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span></span>
<span>    <span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">1</span>, y <span class="op">=</span> <span class="va">utica_mid</span>, label <span class="op">=</span> <span class="st">"Utica Fm"</span>,</span>
<span>    angle <span class="op">=</span> <span class="fl">90</span>, fontface <span class="op">=</span> <span class="st">"bold"</span>, size <span class="op">=</span> <span class="fl">3</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span></span>
<span>    <span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">1</span>, y <span class="op">=</span> <span class="va">pp_mid</span>, label <span class="op">=</span> <span class="st">"Point Pleasant Fm"</span>,</span>
<span>    angle <span class="op">=</span> <span class="fl">90</span>, fontface <span class="op">=</span> <span class="st">"bold"</span>, size <span class="op">=</span> <span class="fl">3</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_reverse</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">ymax</span>, <span class="va">ymin</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">xlim</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2) make tracks</span></span>
<span><span class="va">ca_plot</span>       <span class="op">&lt;-</span> <span class="fu">make_line_track</span><span class="op">(</span><span class="va">spaAlign_full</span>, <span class="va">cols</span><span class="op">$</span><span class="va">ca</span>, <span class="st">"Ca"</span>, col <span class="op">=</span> <span class="st">"salmon"</span><span class="op">)</span></span>
<span><span class="va">si_plot</span>       <span class="op">&lt;-</span> <span class="fu">make_line_track</span><span class="op">(</span><span class="va">spaAlign_full</span>, <span class="va">cols</span><span class="op">$</span><span class="va">si</span>, <span class="st">"Si"</span>, col <span class="op">=</span> <span class="st">"deepskyblue3"</span>, lty <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span></span>
<span><span class="va">toc_plot</span>      <span class="op">&lt;-</span> <span class="fu">make_point_track</span><span class="op">(</span><span class="va">spaAlign_full</span>, <span class="va">cols</span><span class="op">$</span><span class="va">toc</span>, <span class="st">"TOC (wt.%)"</span><span class="op">)</span></span>
<span><span class="va">mbi_plot</span>      <span class="op">&lt;-</span> <span class="fu">make_point_track</span><span class="op">(</span><span class="va">spaAlign_full</span>, <span class="va">cols</span><span class="op">$</span><span class="va">mbi</span>, <span class="st">"MBI"</span><span class="op">)</span></span>
<span><span class="va">clay_plot</span>     <span class="op">&lt;-</span> <span class="fu">make_point_track</span><span class="op">(</span><span class="va">spaAlign_full</span>, <span class="va">cols</span><span class="op">$</span><span class="va">total_clay</span>, <span class="st">"Total_Clay"</span><span class="op">)</span></span>
<span><span class="va">porosity_plot</span> <span class="op">&lt;-</span> <span class="fu">make_point_track</span><span class="op">(</span><span class="va">spaAlign_full</span>, <span class="va">cols</span><span class="op">$</span><span class="va">porosity</span>, <span class="st">"Porosity"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 3) cluster plot (uses same ylims)</span></span>
<span><span class="va">cluster_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">spaAlign_full</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, y <span class="op">=</span> <span class="va">.data</span><span class="op">[[</span><span class="va">depth_col</span><span class="op">]</span><span class="op">]</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">.data</span><span class="op">[[</span><span class="va">cols</span><span class="op">$</span><span class="va">facies</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">1</span>, height <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">yline</span>, color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_reverse</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">ylims</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">facies_colors</span>, labels <span class="op">=</span> <span class="va">chemofacies_labels</span>, name <span class="op">=</span> <span class="st">"chemofacies"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"chemofacies"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span>, size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"right"</span>,</span>
<span>    panel.border <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># 4) combine + print + save  (ADD formation_panel at the far LEFT)</span></span>
<span><span class="va">combined_plot</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">formation_panel</span> <span class="op">+</span> <span class="va">ca_plot</span> <span class="op">+</span> <span class="va">si_plot</span> <span class="op">+</span> <span class="va">toc_plot</span> <span class="op">+</span> <span class="va">mbi_plot</span> <span class="op">+</span> <span class="va">clay_plot</span> <span class="op">+</span> <span class="va">porosity_plot</span> <span class="op">+</span> <span class="va">cluster_plot</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.08</span>, <span class="fl">0.12</span>, <span class="fl">0.12</span>, <span class="fl">0.12</span>, <span class="fl">0.12</span>, <span class="fl">0.12</span>, <span class="fl">0.14</span>, <span class="fl">0.16</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">combined_plot</span><span class="op">)</span></span></code></pre></div>
<p><img src="getting-started_files/figure-html/unnamed-chunk-18-1.png" class="r-plt" alt="" width="700"></p>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="st">"combined_tracks_fullcore.png"</span>, <span class="va">combined_plot</span>, width <span class="op">=</span> <span class="fl">12</span>, height <span class="op">=</span> <span class="fl">5</span>, dpi <span class="op">=</span> <span class="fl">300</span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Hope E. Omodolor, Jeffrey M. Yarus.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
